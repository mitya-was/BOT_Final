# üöÄ –û–Ω–æ–≤–ª–µ–Ω–Ω—è –±–æ—Ç–∞ –Ω–∞ VPS –¥–æ –≤–µ—Ä—Å—ñ—ó 2.0

## üìã **–ü–æ—Ç–æ—á–Ω–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è VPS:**
- **–®–ª—è—Ö –¥–æ –±–æ—Ç–∞:** `/root/telegram-bot`
- **–ü–æ—Ç–æ—á–Ω–∏–π .env:** –í–∂–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π ‚úÖ
- **PM2:** –ü—Ä–∞—Ü—é—î –∑ –ø–æ—Ç–æ—á–Ω–∏–º –±–æ—Ç–æ–º
- **n8n:** –û–∫—Ä–µ–º–∏–π Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
- **–°–∏—Å—Ç–µ–º–∞:** –ì–æ—Ç–æ–≤–∞ –¥–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è

---

## üîÑ **–û–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–æ –≤–µ—Ä—Å—ñ—ó 2.0:**

### **1Ô∏è‚É£ –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ VPS:**
```bash
ssh root@your-vps-ip
cd /root
```

### **2Ô∏è‚É£ –†–µ–∑–µ—Ä–≤–Ω–µ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ –±–æ—Ç–∞:**
```bash
# –°—Ç–≤–æ—Ä–∏—Ç–∏ backup –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó
cp -r telegram-bot telegram-bot-backup-v1
echo "‚úÖ Backup —Å—Ç–≤–æ—Ä–µ–Ω–æ: telegram-bot-backup-v1/"

# –ó—É–ø–∏–Ω–∏—Ç–∏ –ø–æ—Ç–æ—á–Ω–∏–π –±–æ—Ç
pm2 stop all
pm2 delete all
```

### **3Ô∏è‚É£ –ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è –æ–Ω–æ–≤–ª–µ–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç—É:**
```bash
# –ö–ª–æ–Ω—É–≤–∞—Ç–∏ –Ω–æ–≤–∏–π –∫–æ–¥ (–∑–∞–º—ñ–Ω—ñ—Ç—å YOUR_USERNAME)
git clone https://github.com/YOUR_USERNAME/was-contract-bot.git was-contract-bot-v2

# –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π .env —Ñ–∞–π–ª
cp telegram-bot/.env was-contract-bot-v2/telegram-bot/.env

# –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –ª–æ–≥–∏ (—è–∫—â–æ —î)
if [ -d "telegram-bot/logs" ]; then
    cp -r telegram-bot/logs was-contract-bot-v2/telegram-bot/
fi
```

### **4Ô∏è‚É£ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–æ–≤–æ—ó –≤–µ—Ä—Å—ñ—ó:**
```bash
cd was-contract-bot-v2
chmod +x deploy-vps.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è (—Å–∫—Ä–∏–ø—Ç –∞–¥–∞–ø—Ç–æ–≤–∞–Ω–∏–π –ø—ñ–¥ —ñ—Å–Ω—É—é—á—É —Å–∏—Å—Ç–µ–º—É)
./deploy-vps.sh
```

### **5Ô∏è‚É£ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–±–æ—Ç–∏:**
```bash
# –°—Ç–∞—Ç—É—Å –Ω–æ–≤–æ–≥–æ –±–æ—Ç–∞
pm2 status

# –õ–æ–≥–∏ –∑–∞–ø—É—Å–∫—É
pm2 logs was-contract-bot-v2 --lines 20

# –¢–µ—Å—Ç –≤ Telegram
# –ù–∞–¥—ñ—à–ª—ñ—Ç—å /health –±–æ—Ç—É –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏
```

---

## üìä **–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –±–æ—Ç–æ–º:**

### **PM2 –∫–æ–º–∞–Ω–¥–∏:**
```bash
# –°—Ç–∞—Ç—É—Å –≤—Å—ñ—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤
pm2 status

# –õ–æ–≥–∏ –±–æ—Ç–∞
pm2 logs was-contract-bot-v2

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
pm2 restart was-contract-bot-v2

# –ó—É–ø–∏–Ω–∫–∞
pm2 stop was-contract-bot-v2

# –í–∏–¥–∞–ª–µ–Ω–Ω—è –ø—Ä–æ—Ü–µ—Å—É
pm2 delete was-contract-bot-v2

# –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ
pm2 monit
```

### **–õ–æ–≥–∏ –±–æ—Ç–∞:**
```bash
# –õ–æ–≥–∏ —á–µ—Ä–µ–∑ PM2
pm2 logs was-contract-bot-v2 --lines 50

# –õ–æ–≥–∏ –±–æ—Ç–∞ (—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω—ñ)
tail -f telegram-bot/logs/bot-$(date +%Y-%m-%d).log

# –í—Å—ñ –ª–æ–≥–∏ –∑–∞ —Å—å–æ–≥–æ–¥–Ω—ñ
cat telegram-bot/logs/bot-$(date +%Y-%m-%d).log
```

---

## üîç **–î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º:**

### **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤'—è —Å–∏—Å—Ç–µ–º–∏:**
```bash
# –í Telegram –±–æ—Ç—ñ
/health

# –ß–µ—Ä–µ–∑ curl (—è–∫—â–æ —î Web App)
curl "$GOOGLE_SCRIPT_URL?action=health&key=$API_KEY"
```

### **–ß–∞—Å—Ç—ñ –ø—Ä–æ–±–ª–µ–º–∏:**

1. **–ë–æ—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è:**
   ```bash
   # –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ .env —Ñ–∞–π–ª
   cat telegram-bot/.env
   
   # –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ª–æ–≥–∏ –ø–æ–º–∏–ª–æ–∫
   pm2 logs was-contract-bot-v2 --err --lines 20
   ```

2. **API –ø–æ–º–∏–ª–∫–∏:**
   ```bash
   # –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ Google Apps Script URL
   curl -I "$GOOGLE_SCRIPT_URL"
   
   # –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ API –∫–ª—é—á
   echo $API_KEY
   ```

3. **–ü—Ä–æ–±–ª–µ–º–∏ –∑ –ø–∞–º'—è—Ç—Ç—é:**
   ```bash
   # –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å—ñ–≤
   pm2 monit
   
   # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø–µ—Ä–µ–≤–∏—â–µ–Ω–Ω—ñ –ø–∞–º'—è—Ç—ñ
   pm2 restart was-contract-bot-v2
   ```

---

## üîÑ **–û–Ω–æ–≤–ª–µ–Ω–Ω—è –±–æ—Ç–∞:**

### **–û–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–¥—É:**
```bash
# –ó—É–ø–∏–Ω–∏—Ç–∏ –±–æ—Ç
pm2 stop was-contract-bot-v2

# –û–Ω–æ–≤–∏—Ç–∏ –∫–æ–¥ –∑ GitHub
git pull origin main

# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –Ω–æ–≤—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ (—è–∫—â–æ —î)
cd telegram-bot && npm install

# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –±–æ—Ç
pm2 start was-contract-bot-v2
```

### **Rollback –¥–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ—ó –≤–µ—Ä—Å—ñ—ó:**
```bash
# –ó—É–ø–∏–Ω–∏—Ç–∏ –Ω–æ–≤–∏–π –±–æ—Ç
pm2 stop was-contract-bot-v2

# –í—ñ–¥–Ω–æ–≤–∏—Ç–∏ –∑ backup
rm -rf telegram-bot
mv telegram-bot-backup telegram-bot

# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å—Ç–∞—Ä–∏–π –±–æ—Ç
cd telegram-bot
pm2 start bot.js --name was-contract-bot-v1
```

---

## üìà **–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Ç–∞ –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—è:**

### **–©–æ–¥–µ–Ω–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è:**
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É
pm2 status

# –ü–µ—Ä–µ–≥–ª—è–¥ –ª–æ–≥—ñ–≤ –∑–∞ –æ—Å—Ç–∞–Ω–Ω—é –≥–æ–¥–∏–Ω—É
pm2 logs was-contract-bot-v2 --lines 100
```

### **–©–æ—Ç–∏–∂–Ω–µ–≤—ñ –∑–∞–≤–¥–∞–Ω–Ω—è:**
```bash
# –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä–∏—Ö –ª–æ–≥—ñ–≤ (—Å—Ç–∞—Ä—à–µ 7 –¥–Ω—ñ–≤)
find telegram-bot/logs/ -name "*.log" -mtime +7 -delete

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –ø–∞–º'—è—Ç—ñ
pm2 restart was-contract-bot-v2
```

### **–†–µ–∑–µ—Ä–≤–Ω–µ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è:**
```bash
# Backup –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
tar -czf backup-$(date +%Y%m%d).tar.gz telegram-bot/.env telegram-bot/logs/

# Backup –Ω–∞ –≤—ñ–¥–¥–∞–ª–µ–Ω–∏–π —Å–µ—Ä–≤–µ—Ä (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
scp backup-$(date +%Y%m%d).tar.gz user@backup-server:/backups/
```

---

## üîê **–ë–µ–∑–ø–µ–∫–∞:**

### **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó:**
1. **–ù—ñ–∫–æ–ª–∏ –Ω–µ commit—Ç–µ .env —Ñ–∞–π–ª–∏ –≤ Git**
2. **–†–µ–≥—É–ª—è—Ä–Ω–æ —Ä–æ—Ç—É–π—Ç–µ API –∫–ª—é—á—ñ**
3. **–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ firewall –¥–ª—è –æ–±–º–µ–∂–µ–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É**
4. **–ú–æ–Ω—ñ—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –ø—ñ–¥–æ–∑—Ä—ñ–ª—É –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å**

### **–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è firewall:**
```bash
# –î–æ–∑–≤–æ–ª–∏—Ç–∏ —Ç—ñ–ª—å–∫–∏ SSH —Ç–∞ HTTPS
ufw allow ssh
ufw allow https
ufw enable
```

---

## üìû **–ü—ñ–¥—Ç—Ä–∏–º–∫–∞:**

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ:
1. –õ–æ–≥–∏ PM2: `pm2 logs was-contract-bot-v2`
2. –õ–æ–≥–∏ –±–æ—Ç–∞: `tail -f telegram-bot/logs/bot-*.log`
3. –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º–∏: `/health` –≤ Telegram
4. –î–æ—Å—Ç—É–ø–Ω—ñ—Å—Ç—å Google Apps Script

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –¥–æ –ø—Ä–æ–¥–∞–∫—à–Ω—É! üéâ**
